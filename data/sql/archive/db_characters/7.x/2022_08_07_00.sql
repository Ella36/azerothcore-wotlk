-- DB update 2022_08_02_00 -> 2022_08_07_00
--
DROP PROCEDURE IF EXISTS `updateDb`;
DELIMITER //
CREATE PROCEDURE updateDb ()
proc:BEGIN
SELECT COUNT(*) INTO @COLEXISTS
FROM information_schema.COLUMNS
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'character_entry_point' AND COLUMN_NAME = 'taxiPath0';
IF @COLEXISTS = 1 THEN LEAVE proc; END IF;
START TRANSACTION;
ALTER TABLE `character_entry_point` 
    ADD COLUMN `taxiPath0` INT UNSIGNED DEFAULT 0 NOT NULL AFTER `joinMapId`,
    ADD COLUMN `taxiPath1` INT UNSIGNED DEFAULT 0 NOT NULL AFTER `taxiPath0`,
    DROP COLUMN `taxiPath`;
END //
DELIMITER ;

CALL updateDb();


